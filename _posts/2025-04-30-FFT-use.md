---
layout: post
title: 라돈변환과 FFT 그리고 CT
tags: [Radon Transfrom, FFT, Iine Integral, Computer Algorithm]
feature-img: "assets/img/0.post/2024-04-08/chelsea.png"
thumbnail: "assets/img/0.post/2024-04-08/chelsea.png"
categories: ALGORITHM
---

## FFT의 실생활 적용

**푸리에 변환**(Fourier transform, **FT**)은 시간이나 공간에 대한 함수를 시간 또는 공간 주파수 성분으로 분해하는 변환을 말한다.<br>
<br>
**푸리에 급수/변환**의 목적은 어떤 함수 f(t)에 대해 주어진 시간 축에서 다수의 **사인파** 또는 **코사인파**로 분해하는 것이다<br>
<br>
**FFT**는 우리가 인식하지 못할 뿐, **음악**,**영상**,**의료**등 많은 영역에서 사용되고 있다.<br>
<br>
이중 의료 영상 중 **컴퓨터 단층촬영 (CT)**에 도입해 볼 것이다.

## 컴퓨터 단층촬영 (CT)

**컴퓨터단층촬영, CT(Computed Tomography)**는 X선 발생장치가 있는 원통형의 기계를 사용해 내부를 촬영하는 기술, 또는 그러한 기술을 사용한 의학 검사이다. <br>
<br>
![image](https://github.com/user-attachments/assets/754fd546-811c-4de5-8b33-c2b96a859b25)
<br>
위 사진과 같이 X선을 몸에 투영시켜 **감쇠로 인한 값**을 저장하여 사진으로 복원한다<br>
<br>
![image](https://github.com/user-attachments/assets/5867baec-9e57-4cd5-8da2-1fa8f4dcf650)
<br>
**즉, CT촬영 결과의 원본은 우리가 흔히 아는 사진이 아닌 Sinogram으로 이루어져 있다**<br>

![image](https://github.com/user-attachments/assets/134b6633-859b-4bb3-a2ef-0490ec54ca58)
<br> 
저 Sinogram이 어떻게 우리가 흔히 아는 CT사진이 되는지 알아보자

## Radon Transform

수학에서 **라돈 변환**은 평면에서 정의된 함수를 2차원 공간에서 정의된 함수로 변환하는 **적분변환**이다<br>
특정 선에서의 값은 해당 선위의 함수의 **선적분**과 같다<br>
정리하자면, 라돈변환의 핵심 연산은 **선적분**이며 CT촬영에서 몸에 X선을 **여러 각도**로 투과시키면서 **선적분**을 하고, 그 X선 투과결과가 **Sinogram**이다.<br>
<br>
$$
R f(\theta, s) = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f(x, y) \, \delta(x \cos\theta + y \sin\theta - s) \, dx \, dy
$$
<br>

## Inverse Radon Transform

라돈변환으로 Sinogram을 얻는다하더라도 직관적으로 이를 분석하기 어렵다. <br>
따라서 Sinogram을 다시 **역변환**을 해서 우리의 몸 단층의 이미지를 얻는다. <br>
단순히 Sinogram을 다방면으로 **적분**을 해서 원본의 이미지를 얻을것이라 생각할 수도 있지만, **그렇지 않다**<br>
적분만으로 역변환을 할 경우, **이미지가 퍼져서 흐릿해보일 수 있기 때문에** 다음과 같은 과정을 거쳐야 한다.
<br>

> - **Frequency domain filtering(주파수 도메인 필터링)**
> - **BackProjection(백프로젝션)**
<br>


#### Frequency Domain Filtering (주파수 도메인 필터링)

위에 말했듯이 라돈변환은 **저주파가 강조되서** 단순히 적분만 하면 흐릿해 지기 때문에 먼저 **필터링** 과정을 거친다. <br>
크게 보면 **신호나 이미지르르 더 정확히 해석하고 원하는 정보만 추출하기 위해서**이다.<br>

**필터링 과정**
<br>
> - 각도 𝜃마다 $R_f(\theta, s)$을 추출한다
> - s에 대해 **푸리에 변환**을 사용해서 **주파수** 변환한다
> - **주파수로 바꾸면 원하는 부분만 쉽게 조작할 수 있다**
> - 주파수에 **$H(\omega)$** 곱한다 (대표적으로 **Ram-lak filter**)
> - 다시 **푸리에 역변환**을 한다

<br>
**Fourier Transform 사용 이유**
<br>
**시간 영역**에서 필터링은 복잡하지만 **주파수 영역**에서는 **단순 곱셈**으로 나온다<br>

$$
x(t) * h(t) \xrightarrow{\mathcal{F}} X(\omega) \cdot H(\omega)
$$

<br>
**Ram-Lak Filter**
<br>
위에 주파수에 곱하는 **필터 함수**에서 대표적으로 사용하는 것이다.<br>
<br>

$$
H(\omega) = |\omega| \quad \text{(high-pass filter)}
$$
<br>

> - 저주파 성분 억제 (라돈변환은 저주파가 강조된다)
> - 고주파 강조 (경계를 살려서 흐림을 방지한다)




















