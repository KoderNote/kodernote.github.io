---
layout: post

title: Linear Algebra, 주축정리 (Principal axis theorem)

tags: [Linear Algebra, CSE, Data Science, AI, 한국어]

feature-img: "assets/img/0.post/linear/strang.jpg"

thumbnail: "assets/img/0.post/linear/strang.jpg"

categories: CSE, AI
---
## 주축정리 (Principal axis theorem)

원서 : **Strang, G. (2023). *Introduction to Linear Algebra* (6th ed.).** <br>

#### 1. 주축정리 (printcipal axis theorem)

원뿔곡선 C의 방정식을

$$
ax^2 + 2bxy + cy^2 + dx + ey = k
$$

이라 하고, 다음과 같이 정리하자.

$$
ax^2 + 2bxy + cy^2 = (x,y) 
\begin{pmatrix}
a & b \\
b & c
\end{pmatrix}
\binom{x}{y} = v^T A v
$$

이때, A는 대칭행렬이므로 직교대각화가 가능하다. <br>

여기서 A를 직교대각화 시키는 직교행렬 P를 생각하고 det(P) = 1이라 하자.

그리고

$$
v = P w \iff 
\binom{x}{y} = P \binom{X}{Y}
$$

위와 같이 치환하면 방정식

$$
ax^2 + 2bxy + cy^2 + dx + ey + f = 0
$$

은 A의 고유치가 λ1​,λ2​일 때, 다음과 같이 변환된다.

$$
\lambda_1 X^2 + \lambda_2 Y^2 + DX + EY = k
$$

이 치환은 xy 좌표계와 XY 좌표계 사이의 축회전이며, <br>좌표계의 주축끼리의 사잇각은 다음과 같다.

$$
\cot 2\theta = \frac{a - c}{2b}
$$

또한, 원뿔곡선의 개형은 다음과 같이 행렬식으로 판별할수 있다. <br>

① det(A)>0 : 타원 <br>② det(A)<0 : 쌍곡선 <br>③ det(A)=0 : 포물선 <br>

주축정리는 위와 같고 핵심적인 내용들은 다음부분이다.

<br>

#### 2. 축회전과 점회전

θ만큼 **반시계방향**으로 **축회전**했다는 것은 다시말해 θ만큼 **시계방향**으로 **점을 회전**한 것과 같다. <br>

이해를 위해 그림을 참고하자. <br>

<img width="721" height="565" alt="image" src="https://github.com/user-attachments/assets/5ebabca0-f23d-48c0-827b-ed1192492e52" />
<img width="507" height="560" alt="image" src="https://github.com/user-attachments/assets/a99fda6a-c59b-4070-b58f-14aa06771d28" />
<img width="576" height="562" alt="image" src="https://github.com/user-attachments/assets/e726a28c-324f-4eb9-bf16-b5cbc79df344" />


이게 생각보다 어떠한 이차형식에서 원래의 모양을 찾을때 시계방향인지 반시계방향인지 헷갈릴 수 있는데 그냥 축회전이든 점회전이든 한개의 기준을 갖고 생각하면 훨씬 수월하다. <br>

<br>

시계방향으로 점을 회전했기때문에 회전행렬은 다음과 같다.

$$
\begin{pmatrix}
\cos\theta & \sin\theta \\
-\sin\theta & \cos\theta
\end{pmatrix}
\binom{x}{y}
=
\binom{X}{Y}
$$

① 점회전:

$$
\begin{pmatrix}
C & -S \\
S & C
\end{pmatrix}
\binom{X}{Y}
=
\binom{x_0}{y_0}
$$

② 축회전:

$$
\begin{pmatrix}
C & S \\
- S & C
\end{pmatrix}
\binom{x}{y}
=
\binom{X}{Y}
$$

이때 회전행렬이 직교이고 양변에 역행렬을 곱해주면 다음과 같다.

$$
\binom{x}{y}
=
\begin{pmatrix}
C & S \\
- S & C
\end{pmatrix}^{-1}
\binom{X}{Y}
$$

즉, 다음과 같이 표시할수 있고

$$
v = Pw
$$

직교행렬의 역행렬은 전치이므로 다음과 같다.

$$
\binom{x}{y}
=
\begin{pmatrix}
C & -S \\
S & \;\;C
\end{pmatrix}
\binom{X}{Y}
$$

따라서 축회전의 시계방향은 점회전의 반시계인것을 확인할 수 있다.<br>

<br>

#### 3. APPLICATION

개인적으로 주축정리를 이용하는 이유중 하나는 xy같은 변수 2개가있는 이차항 때문이라고 생각한다. <br>

다음과 같은 이차형식이 있다고 할때, xy항때문에 이게 어떤 모양인지 인식하기 힘들다.

$$
x^2 + xy + y^2
$$

만약에 xy항이 없다면 원일텐데 xy항때문에 알 수 없기때문에 이를 해석하는 응용을 해보자.<br>

<br>

다음과 같은 이차형식이 있을때

$$
ax^2 + 2bxy + cy^2 \;\;\;\;\; \Leftrightarrow \;\;\;\;\; \text{quadratic form}
$$

다음과 같이 바꿀 수 있다.

$$
(x \;\; y)
\begin{pmatrix}
a & b \\
b & c
\end{pmatrix}
\binom{x}{y}
\;\;\;\;\; \Leftrightarrow \;\;\;\;\; v^T A v
$$

이때 가운데 A는 대칭행렬이다. <br>

그리고 이를 v = pw를 이용해 축회전을 시켜주면 다음과 같다.

$$
(Pw)^T A (Pw) \;\;\;\;\; \text{(치환: } v = Pw \text{)}
$$

$$
= w^T P^T A P w
$$

여기서 직교대각화를 하여 다음과 같이 나온다.

$$
w^T D w
$$

그리고 여기서 D는 고유치를 주대각원소로 같는 행렬이므로 다음과 같이 쓸수있고

$$
= (X \;\; Y)
\begin{pmatrix}
\lambda_1 & 0 \\
0 & \lambda_2
\end{pmatrix}
\binom{X}{Y}
$$

그럼 다음과 같은 결과를 얻을 수 있다.

$$
= \lambda_1 X^2 + \lambda_2 Y^2
$$

<br>

이런 방식으로 xy항을 없애서 원래의 모양을 판별할 수 있다. <br>

만약에 고유치가 둘다 양수면 타원이고 한쪽이 음수이면 쌍곡선이고 한쪽이 0이면 직선이 되는 식이다. <br>

<br>

이해를 위해 문제를 몇가지 풀어보자. <br>

<br>

첫번째는 직교대각화 문제이다. <br>

##### 문제 1

이차형식 ax2+2bxy+cy2이 kt^2로 직교대각화(orthogonally diagonalized)되기 위한 동치 조건을 구할 때, 상수 k의 값은? <br>

<br>

다음과 같이 직교대각화가 되기 위해서는 고유치 하나는 0이 되어야 한다. <br>

따라서 다음과같은 특성다항식에서 다음과 같은 결과를 얻는다.

$$
\lambda^2 - (a+c)\lambda + ac - b^2 
= \lambda(\lambda - k) 
= \lambda^2 - k\lambda 
\;\;\;\;\;\;\;\; \Rightarrow \;\;\;\;\;\;\;\;
k = a + c
$$

<br>

<br>

#### 문제 2

이차곡면(quadratic surface) 2xy + 2xz = 1을 분류할때 이 곡면의 모양은?<br>

<br>

3차원의 이차곡면이지만 2차원이랑 거의 동일하고 이차형식에서 3변수 바꾸는 방법을 기억하면 쉽게 풀지만 막상 곡면의 형태를 모를수도있으니 곡면의 형태도 숙지하자. <br>

$$
A = 
\begin{pmatrix}
0 & 1 & 1 \\
1 & 0 & 0 \\
1 & 0 & 0
\end{pmatrix}
$$

다음행렬의 고유방정식은 다음과 같다

$$
\lambda (\lambda + \sqrt{2})(\lambda - \sqrt{2}) = 0
$$

따라서 고유값은 다음과 같다.

$$
\sqrt{2}, \; -\sqrt{2}, \; 0
$$

주축정리에 의해 다음과 같이 정리되고 따라서 주어진 이차곡면은 **쌍곡선기둥**이다.

$$
\sqrt{2}(x')^2 - \sqrt{2}(y')^2 = 1 
\;\;\;\Longleftrightarrow\;\;\;
(x')^2 - (y')^2 = \frac{1}{\sqrt{2}}
$$

**참고** <br>

쌍곡선기둥의 모양은 부족하지만 다음을 참고하자

<img width="604" height="525" alt="image" src="https://github.com/user-attachments/assets/5f06c91d-7f8d-4cb6-88e9-a6e9d0a31017" />


<br>

<br>

##### 문제3

이차형식 x^2+4xz+2y^2+z^2을 직교대각화(orthogonal diagonalization)하면, a1​X^2+a2​Y^2+a3​Z^2이다. 이때, Z=αx+βy+γz 이면 α+β+γ 의 값은? <br>

(단, a1​<a2​<a3​) <br>

<br>

주축정리를 이용해서 천천히 전개하며 풀어보자 <br>

문제의 이차형식을 정리하면 다음과 같다.

$$
x^2 + 4xz + 2y^2 + z^2 
= (x \; y \; z)
\begin{pmatrix}
1 & 0 & 2 \\
0 & 2 & 0 \\
2 & 0 & 1
\end{pmatrix}
\binom{x}{y}{z}
= v^T A v
$$

이를 직교대각화하면 다음과 같이 나온다

$$
(X \; Y \; Z)
\begin{pmatrix}
-1 & 0 & 0 \\
0 & 2 & 0 \\
0 & 0 & 3
\end{pmatrix}
\binom{X}{Y}{Z}
$$

그럼 고유치 -1, 2, 3 에 대응하는 각각의 고유벡터를 구하면 다음과 같이 나온다.

$$
v_1 = \begin{pmatrix} 1 \\ 0 \\ -1 \end{pmatrix}, \quad
v_2 = \begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix}, \quad
v_3 = \begin{pmatrix} 1 \\ 0 \\ 1 \end{pmatrix}
$$

따라서

$$
P =
\begin{pmatrix}
\frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}} \\
0 & 1 & 0 \\
-\frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}}
\end{pmatrix}
$$

이므로 양의 y축방향의 회전임을 알 수 있고 다음과 같이 정리할 수 있다.

$$
\begin{pmatrix} x \\ y \\ z \end{pmatrix}
=
\begin{pmatrix}
\frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}} \\
0 & 1 & 0 \\
-\frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}}
\end{pmatrix}
\begin{pmatrix} X \\ Y \\ Z \end{pmatrix}
\;\;\;\;\;\;\Rightarrow\;\;\;\;\;\;
\begin{pmatrix} X \\ Y \\ Z \end{pmatrix}
=
\begin{pmatrix}
\frac{1}{\sqrt{2}} & 0 & -\frac{1}{\sqrt{2}} \\
0 & 1 & 0 \\
\frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}}
\end{pmatrix}
\begin{pmatrix} x \\ y \\ z \end{pmatrix}
$$

즉

$$
Z = \frac{1}{\sqrt{2}}x + \frac{1}{\sqrt{2}}z
$$

$$
\alpha + \beta + \gamma = \sqrt{2}.
$$

<br>

<br>

##### 문제4

선형사상 T:R3→R3 은 직선 x=−y=z를 중심으로 120∘ 회전하는 사상이다. <br>

T(1,2,3)=(a,b,c)라 할 때, a+2b+3c의 값은? <br>

<br>

<br>

직선에 대한 회전이므로 앞서 언급한 로드리게스 회전변환 공식을 사용해서 풀어야 한다. <br>

직선의 방향벡터를 구하면 다음과 같다.

$$
\vec{v} = \frac{1}{\sqrt{3}} (1, -1, 1), \quad \theta = \frac{2}{3}\pi
$$

그리고 이에 대한 회전행렬은 다음과 같다. (로드리게스 회전변환 공식 사용)

$$
\begin{pmatrix}
a^2 + (1-a^2)\cos\theta & ab(1-\cos\theta) - c\sin\theta & ac(1-\cos\theta) + b\sin\theta \\
ab(1-\cos\theta) + c\sin\theta & b^2 + (1-b^2)\cos\theta & bc(1-\cos\theta) - a\sin\theta \\
ac(1-\cos\theta) - b\sin\theta & bc(1-\cos\theta) + a\sin\theta & c^2 + (1-c^2)\cos\theta
\end{pmatrix}
$$

이를 계산하면 다음과 같이나온다

$$
\begin{pmatrix}
0 & -1 & 0 \\
0 & 0 & -1 \\
1 & 0 & 0
\end{pmatrix}
$$

즉

$$
T(1,2,3) = (-2,-3,1)
$$

$$
a + 2b + 3c = -5
$$

<br>

<br>

##### 문제5

입체 S = { (x, y, z) | 3x^2 - 2xy + 3y^2 + 8z^2 ≤ 16 } 의 부피는?

<br>

<br>

이차형식을 정리하면 다음과 같다.

$$
3x^2 - 2xy + 3y^2 + 8z^2 
= [ \; x \; y \; z \; ]
\begin{pmatrix}
3 & -1 & 0 \\
-1 & 3 & 0 \\
0 & 0 & 8
\end{pmatrix}
\begin{pmatrix}
x \\ y \\ z
\end{pmatrix}
$$

따라서

$$
(8 - \lambda)(\lambda - 2)(\lambda - 4) = 0
$$

각 고유치에 대응하는 고유벡터는 다음과 같다

$$
\begin{pmatrix} 1 \\ 1 \\ 0 \end{pmatrix}, \quad
\begin{pmatrix} 1 \\ -1 \\ 0 \end{pmatrix}, \quad
\begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix}
$$

주축정리에 의해

$$
[x \; y \; z]
\begin{pmatrix}
3 & -1 & 0 \\
-1 & 3 & 0 \\
0 & 0 & 8
\end{pmatrix}
\begin{pmatrix}
x \\ y \\ z
\end{pmatrix}
\leq 16
\;\;\;\;\;\;\Rightarrow\;\;\;\;\;\;
[u \; v \; w]
\begin{pmatrix}
2 & 0 & 0 \\
0 & 4 & 0 \\
0 & 0 & 8
\end{pmatrix}
\begin{pmatrix}
u \\ v \\ w
\end{pmatrix}
\leq 16
$$

여기서 문제에서 부피라고 말하긴했지만 만약 부피를 언급하지 않고 <=이면 부피지만, =로 해당하면 내부는 포함안하므로 겉넓이다.

$$
2u^2 + 4v^2 + 8w^2 \leq 16
$$

타원구형태가 나오므로 타원구 부피공식을 사용하면 풀린다. <br>

참고로 타원구 부피공식은 3파이/4 * abc 이다. <br>

답은 32pi/3나온다.
