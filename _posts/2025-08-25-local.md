---
layout: post

title: Calculus, 2변수 함수의 극대와 극소

tags: [Calculus , CSE, Data Science, AI, Optimization]

feature-img: "assets/img/stuwart.png"

thumbnail: "assets/img/stuwart.png"

categories: CSE, AI, Calculus, Optimization
---

## 이변수 함수의 극대와 극소

1변수함수에 이은 이변수 크게는 다변수에서의 극대와 극소이다. <br>

convex, concave를 넘어 이제는 안장점(saddle point) 까지 판별해야 한다.<br>
원서 : **Stewart, J. (2016). *Calculus: Early Transcendentals* (8th ed.).**
<br>

#### 1. 극대, 극소 (local maximum & local minimum)

함수 f(x, y) 에서, 양수 δ > 0 가 존재하여 0 < √(h² + k²) < δ 가 되는 모든 h, k 에 대하여

$$
f(a+h, b+k) ≤ f(a, b)
$$

이면 f(x,y)는 x = a, y = b 에서 **극대** 가 된다고 하고, f(a, b)를 **극댓값**이라고 한다.<br>

또한<br>

$$
f(a+h, b+k) ≥ f(a, b)
$$

이면 f(x,y)는 x = a, y = b 에서 **극소** 가 된다고 하고, f(a, b)를 **극솟값**이라고 한다. <br>

<br>

함수 f(x,y)가 점 (a, b)의 어떤 근방에서 연속인 편도함수 fx, fy 를 가질 때, <br>함수 f(x,y)가 x=a, y=b 에서 **극대** 가 되므로 x=a, y=b 에서의 미분계수, 즉 fx(x,y)의 x = a, y = b 에서의 x에 관한 **편미분계수 fx(a, b) = 0** 이다. 마찬가지로 fy(a, b) = 0 이다.

<br>

<br>

#### 2. 극대, 극소 판정법

f(x, y)가 점 (a, b)의 어떤 근방에서 연속인 편도함수를 가질 때, f(x, y)가 x = a, y = b 에서 극대 또는 극소가 되면 fx(a, b) = 0, fy(a, b) = 0 ((a, b)는 **임계점 (critical point)** ) 이다. <br>

또한 z=f(x, y)가 점 (a, b)의 근방에서 연속인 2계 편도함수를 가지며

$$
\Delta(x, y) = f_{xx}(x, y) f_{yy}(x, y) - \big(f_{xy}(x, y)\big)^2


$$

라고 하면 다음을 만족한다.

① Δ(a, b) > 0 이고 fxx(a, b) < 0 이면 점 (a, b)는 극대점이고 f(a, b)는 극댓값이다. <br>

② Δ(a, b) > 0 이고 fxx(a, b) > 0 이면 점 (a, b)는 극소점이고 f(a, b)는 극솟값이다. <br>

③ Δ(a, b) < 0 이면 점 (a, b)는 **안장점(saddle point)** 이다. <br>

④ **Δ(a, b) = 0 이면 이 판정법으로는 판정이 불가능하다.** <br>

<br>

안장점 예시 <br>

<img width="694" height="572" alt="image" src="https://github.com/user-attachments/assets/853907b1-4307-4a81-bf78-2d6b1c293538" />

<br>
이 판정법은 **헤세의 행렬(Hessian metrix)** 에서 나온 것으로 앞으로 최적화(optimization)이나 다변수에서의 2계도함수에서 많이 접하므로 기억하자. <br>

<br>

#### 3. Hessian metrix

Hessian metrix를 사용해서 앞서 언급한 판정법을 재해석하면 다음과 같다. <br>

w = f(x₁, x₂, x₃, … , xₙ) 일 때, ∇f = (fₓ₁, fₓ₂, … , fₓₙ) = (0, 0, … , 0) 을 만족하는 점 p(x₁, x₂, x₃, … , xₙ)을 임계점이라 한다. <br>

다음은 **Hessian metrix (Symmetry metrix)** 이다.

$$
H(f) =
\begin{bmatrix}
f_{x_1x_1} & f_{x_1x_2} & \cdots & f_{x_1x_n} \\
f_{x_2x_1} & f_{x_2x_2} & \cdots & f_{x_2x_n} \\
\vdots & \vdots & \ddots & \vdots \\
f_{x_nx_1} & f_{x_nx_2} & \cdots & f_{x_nx_n}
\end{bmatrix}
$$

① 해세의 행렬이 양의 정부호행렬이면 임계점은 극소점 <br>

② 해세의 행렬이 음의 정부호행렬이면 임계점은 극대점 <br>

③ det(H(a)) ≠ 0 이지만 해세의 행렬이 부정부호행렬이면 임계점은 안장점 <br>

④ **det(H(a)) = 0 이면 판정 불가** <br>

<br>

그리고 증명은 다음과 같다. (사실 증명부분을 깊게 보는것 보다는 직접 풀어보는게 편하다)

<br>

**참고** <br>

**증명** <br>

f(t) = f(a+ht, b+kt) (단, x=a+ht, y=b+kt : h, k는 상수)로 놓으면 F(t) (즉 f(x,y))는 F'(0)=0이고, <br>F''(0)<0일 때 극대값 F(0) [즉 f(x,y)]를 가지며, F''(0)>0일 때 극소값 F(0) [즉 f(x,y)]를 갖는다. <br>F'(0)=0은 fₓ(a,b)=0, fᵧ(a,b)=0임을 가리킨다. 왜냐하면, h, k에 관계없이 다음 식이 성립하기 때문이다. <br>

$$
F'(0)=h fₓ(a,b)+k fᵧ(a,b)=0
$$

또한 다음식이고

$$
F''(0) = h² fₓₓ(a,b )+ 2hk fₓᵧ(a,b) + k² fᵧᵧ(a,b) \quad .... \quad ①
$$

fₓₓ != 0 이면 (fₓₓ=fₓₓ(a,b), fₓᵧ=fₓᵧ(a,b), fᵧᵧ=fᵧᵧ(a,b)로 표기.) <br>

fₓᵧ / fᵧₓ 이면 ①의 좌변에 곱하고 분자를 완전 제곱꼴로 고치면 다음과 같다. <br>

$$
F''(0) = \frac{(h f_{xx} + k f_{xy})^2}{f_{xx}} + k^2 \frac{(f_{xx} f_{yy} - f_{xy}^2)}{f_{xx}}, \quad (f_{xx} \neq 0)
$$

fᵧᵧ ≠ 0이면 마찬가지로 다음을 만족한다

$$
F''(0) = \frac{(h f_{xy} + k f_{yy})^2 + h^2 (f_{xx} f_{yy} - f_{xy}^2)}{f_{yy}}, \quad (f_{yy} \neq 0)
$$

<br>

① Δ = fₓₓfᵧᵧ - fₓᵧ² > 0 이고, fₓₓ < 0 [또는 fᵧᵧ < 0] 이면 위의 식에서 F''(0) < 0이므로 **극댓값 F(0)**, 즉 f(a,b)를 갖는다. <br>

② Δ = fₓₓfᵧᵧ - fₓᵧ² > 0이고, fₓₓ > 0 [또는 fᵧᵧ > 0]이면 위의 식에서 F''(0) > 0이므로 **극솟값 F(0)**, 즉 f(a,b)를 갖는다.<br>

③ Δ < 0이면 부호가 h와 k의 선택에 따라 양으로도 되고 음으로도 되므로 f(a,b)는 극값일 수 없다. <br>

a(b, f(a,b))를 이 때의 **안장점(saddle point)** 이라 한다. <br>

④ 이를테면 h + k ≠ 0인 경우, fₓₓ = fᵧᵧ = fₓᵧ = 1일 때 Δ = 0이지만 ① 에서 F''(0) > 0으로 되어 f(a,b)는 극솟값이다. <br>

그런데 fₓₓ = fᵧᵧ = fₓᵧ = -1일 때에도 Δ = 0이지만 ①에서 F''(0) < 0으로 되어 f(a,b)는 극댓값이다. <br>

**그러므로 Δ = 0만으로서는 극대, 극소를 알 수 없다.** <br>

<br>
예제를 푸는것이 더 이해하기 빠르다. <br>

##### 문제 1

다음 곡면에 대해 올바른 것을 모두 고른것은?

$$
f(x,y) = x^3 - y^3 + 3x^2 + 3y^2 - 9x - 5
$$

(a) 임계점이 4개이다. <br>(b) 극대점이 1개이다. <br>(c) 안정점이 1개이다. <br>(d) 극소점이 1개이다. <br>

<br>

처음에는 전개가 귀찮지만 나중가면 바로바로 적용가능하니 처음에는 하나하나 신경쓰면서 푸는것이 낫다. <br>

과정의 큰 틀은 각각 x, y로 편미분해서 임계점을 구한뒤, Hessian metrix의 determinant로 판별한다. 이때 0보다 크면 극대 또는 극소이고, 0보다 작으면 안장점, 그리고 0이면 판정 불가이다. <br>

그 뒤 임계점을 fxx와 fyy에 대입해서 답을 찾아낸다. <br>

대부분 위 과정으로 끝나니 풀면서 익숙해지자. <br>

<br>

**x, y 편미분** <br>

$$
f_x = 3x^2 + 6x - 9 = 0 \quad \therefore x = 1, -3
$$

$$
f_y = -3y^2 + 6y = 0 \quad \therefore y = 0, 2
$$

따라서 임계점은 (1,0),(1,2),(−3,0),(−3,2)이다. <br>

**Hessian 판별** <br>

$$
\Delta(x,y) = (6x+6)(-6y+6) - (0)^2
$$

임계점을 판별하면 (1,2),(−3,0)은 안장점이고, <br>(1,0)은 극소점, (−3,2)는 극대점을 이룬다. <br>

따라서 답은 각각 참,참,거짓,참이다.

<br>

<br>

##### 문제 2

다음 함수에 대해서 옳은 것을 모두 고른 것은?

$$
f(x,y) = xy - \frac{1}{3}(x^3 + y^3)
$$

(가) (1,1)에서 극댓값을 갖는다. <br>

(나) (0,0)에서 극솟값을 갖는다. <br>

(다) 단 하나의 안정점을 갖는다. <br>

(라) (0,1)에서 ⟨0,1⟩ 방향으로 증가상태에 있다. <br>

<br>

위와 같은 과정으로 풀면 된다. <br>

(라) 조건만 유의하자. <br>

마찬가지로 x, y에 대해 편미분 한다. <br>

$$
f_x = y - x^2 = 0, \quad f_y = x - y^2 = 0
$$

이를 연립하면 임계점은 (0,0),(1,1)이다. <br>

그리고 판별을 하면 다음과 같다.

$$
\Delta(x,y) = (-2x)(-2y) - (1)^2
$$

임계점을 판별하면 (0,0)은 안장점이고 (1,1)은 극대점을 이룬다. <br>

이제 조건을 확인하면 <br>

(가) (1,1)에서 극댓값을 갖는다. [참] <br>

(나) (0,0)에서 극솟값을 갖는다. [거짓] <br>

(다) 단 하나의 안정점을 갖는다. [참] <br>

여기서

$$
\nabla f(0,1) = (1,-1)
$$

이고 (1,−1)⋅(0,1)=−1이므로 방향도함수가 음수 → (0,1)에서 ⟨0,1⟩ 방향으로 감소상태이다. <br>

따라서 (라) (0,1)에서 ⟨0,1⟩ 방향으로 증가상태에 있다. [거짓] <br>
