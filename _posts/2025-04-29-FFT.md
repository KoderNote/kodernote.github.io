---
layout: post
title: 고속푸리에변환(FFT)
tags: [FFT, Data Science]
feature-img: "assets/img/0.post/2024-04-08/chelsea.png"
thumbnail: "assets/img/0.post/2024-04-08/chelsea.png"
categories: ALGORITHM
---

## 푸리에 변환이란?

**푸리에 변환**(Fourier transform, **FT**)은 시간이나 공간에 대한 함수를 시간 또는 공간 주파수 성분으로 분해하는 변환을 말한다.<br>
<br>
푸리에 변환은 일종의 **적분 변환**으로, **리만 이상적분**이기 때문에 복잡한 적분 이론을 요구하는 응용분야에서는 적합하지 않을 수 있으며, 푸리에 변환은 파동과 양자역학뿐 아닌 공간이나 운동량 또는 둘 모두를 함수로 표현할 때 **파동 공식 표현**이 중요한 분야에서 자연스럽게 사용하고 있다. <br>
<br>
일반적으로 푸리에 공식이 적용가능한 함수는 **복소수**이며, 벡터값을 가질 수 있다.

### **복소수**에 푸리에 공식을 적용하는 이유

**푸리에 급수/변환**의 목적은 어떤 함수 f(t)에 대해 주어진 시간 축에서 다수의 **사인파** 또는 **코사인파**로 분해하는 것이다.

![image](https://github.com/user-attachments/assets/ba9ba893-c23f-4c72-a275-0439d2762118)


현실에서 보통 다루는 함수 f(t)는 보통 **실수값 함수**이다. <br>
하지만 푸리에 급수/변환 에서는 **복소지수함수 e^iωt**를 기본 벡터를 사용한다. 이유는 **복소지수함수를 이용해 사인과 코사인을 동시에 표현할 수 있기 때문이다.**
<br>
<br>
**오일러 공식** <br>
<br>
![image](https://github.com/user-attachments/assets/e6106ebc-8faf-4216-888d-e9c57a188bca)
<br>
<br>
## 푸리에 변환 / 이산 푸리에 변환(DFT)
<br>
**푸리에 변환** <br>
<br>
![image](https://github.com/user-attachments/assets/38a40f69-b231-4b9b-b804-a3c8bd7a6ab3) <br>

> - 입력: 연속시간 함수
> - 출력: 연속 주파수 함수
> - 아날로그 연속신호
<br>

**이산 푸리에 변환** <br>
<br>
![image](https://github.com/user-attachments/assets/e424924c-3aaf-472e-9fcc-2ae2744001a9)

> - 입력: **유한개**의 **이산**샘플
> - 출력: 유한개
> -  컴퓨터에서 다루는 디지털데이터(**디지털신호**)

여기서 **$$- \frac{2\pi i}{N} kn$$** 는 **회전 각도**를 나타냄
<br>
<br>
**BFT(이산 푸리에 변환) 코드**
<br>
```python
import numpy as np

def dft(x):
    N = len(x)
    X = np.zeros(N, dtype=complex)

    for k in range(N):
        for n in range(N):
            angle = -2j * np.pi * k * n / N
            X[k] += x[n] * np.exp(angle)
    
    return X
```
<br>
보통 입력값 x는 시간영역의 **신호** 이고 **N의 길이를 가진 복소수 또는 실수 배열**이다<br>
BFT의 output담을 입력값과 같은 길이의 **복소수 배열(dtype = complex)**을 생성한다<br>
이중 for문으로 푸리에 변환 공식을 적용하여 X에 넣은후 return한다.
이중 for문으로 구성되어있기 때문에 시간복잡도는 **O(N^2)**이다.


## 고속 푸리에 변환 (FFT)
이산푸리에변호나을 빠르게 계산
직접계산하면 게산량이 O(N^2)
O(NlogN)

입력길이를 2의 거듭제곱으로 맞춤
재귀적으로 반씩나누기때문에 N은 2^k형태
아닐경우 제로팬딩(다 0으로 매꿈)

짝수/홀수 인덱스 분활(핵심)
