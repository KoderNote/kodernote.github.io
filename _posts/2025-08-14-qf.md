---
layout: post

title: Linear Algebra, 이차형식 (Quadratic Form)

tags: [Linear Algebra, CSE, Data Science, AI, 한국어]

feature-img: "assets/img/0.post/linear/strang.jpg"

thumbnail: "assets/img/0.post/linear/strang.jpg"

categories: CSE, AI
---
## 이차형식 (Quadratic Form)

이차형식(Quadratic Form)은 Mahalanobis 거리공식이나 축회전 등에서 널리 쓰이는 이론이다. <br>

확률, 데이터분석, CS 등 많은 분야에서 쓰이니 숙지하자. <br>

원서 : **Strang, G. (2023). *Introduction to Linear Algebra* (6th ed.).** <br>

<br>

#### 1. 이차형식 (Quadratic Form)

두 변수 x,y에 관한 **2차형식(quadratic form)** 다음으로 표기될 수 있는 식으로 정의된다. <br>

$$
ax^2 + 2bxy + cy^2 \tag{a}
$$

만약 1x1행렬에 대한 괄호를 생각한다면 행렬식으로 다음과 같이 쓸 수 있다.

$$
ax^2 + 2bxy + cy^2 = (x \; y)
\begin{pmatrix}
a & b \\
b & c
\end{pmatrix}
\begin{pmatrix}
x \\
y
\end{pmatrix} \tag{b}
$$

위의 2x2행렬은 대칭행렬이고 대각선의 성분은 제 2차항의 계수이며 주대각선을 제외한 성분은 모두 곱 xy 항인 계수의 **1/2**임을 유의하자.

$$
2x^2 + 6xy - 7y^2 = (x \; y)
\begin{pmatrix}
2 & 3 \\
3 & -7
\end{pmatrix}
\begin{pmatrix}
x \\
y
\end{pmatrix}
$$

$$
4x^2 - 5y^2 = (x \; y)
\begin{pmatrix}
4 & 0 \\
0 & -5
\end{pmatrix}
\begin{pmatrix}
x \\
y
\end{pmatrix}
$$

$$
xy = (x \; y)
\begin{pmatrix}
0 & \tfrac{1}{2} \\
\tfrac{1}{2} & 0
\end{pmatrix}
\begin{pmatrix}
x \\
y
\end{pmatrix}
$$

<br>

<br>

#### 2. n개의 변수에 관한 이차형식

n개의 변수에 x1,x2, ..., xn에 관한 2차형식은 다음과 같이 표현될수 있고, 여기서 A는 **nxn 대칭행렬**이다.

$$
(x_1 \; x_2 \; \cdots \; x_n) A 
\begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_n
\end{pmatrix} \tag{c}
$$

만약

$$
v = 
\begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_n
\end{pmatrix}
$$

이라 놓으면 (c)는 간결하게 다음과 같이 쓸 수 있다.

$$
v^T A v \tag{d}
$$

그리고 (d)의 행렬을 곱하면 그 결과식은 다음과 같은 형식이 되고 이를 **2차형식의 혼합형** 이라 한다.

$$
v^T A v = a_{11}x_1^2 + a_{22}x_2^2 + \cdots + a_{nn}x_n^2
+ \sum_{i \neq j} a_{ij} x_i x_j
$$

대칭행렬은 2차형식을 행렬로 표현하는 데 유용하지만 꼭 필수적인 것은 아니다.<br>

예를들어, 다음과 같이도 쓸수 있다.

$$
2x^2 + 6xy - 7y^2 
= (x \; y)
\begin{pmatrix}
2 & 5 \\
1 & -7
\end{pmatrix}
\begin{pmatrix}
x \\
y
\end{pmatrix}
= (x \; y)
\begin{pmatrix}
2 & 4 \\
2 & -7
\end{pmatrix}
\begin{pmatrix}
x \\
y
\end{pmatrix}
$$

하지만 일반적으로 대칭행렬이 가장 간단한 결과를 보여주니 이를 자주 사용한다. <br>

참고로 A가 대칭이라면 내적에 의해 다음과 같이 쓸 수 있다.

$$
v^T A v = v^T (Av) = Av \cdot v = v \cdot Av
$$

다음은 x1, x2, x3에 관한 2차형식이다.

$$
x_1^2 + 7x_2^2 - 3x_3^2 + 4x_1x_2 - 2x_1x_3 + 6x_2x_3
= (x_1 \; x_2 \; x_3)
\begin{pmatrix}
1 & 2 & -1 \\
2 & 7 & 3 \\
-1 & 3 & -3
\end{pmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
x_3
\end{pmatrix}
$$

제곱항의 계수는 3x3행렬의 주 대각선상에 나타나고 혼합형의 계수는 각각 반으로분리되어 다음과 같이 주 대각선 의외의 위치에 나타남을 유의하자.<br>

<br>

#### 3. 회전변환

① ℝ²일때, 평면 위에서 원점을 중심으로 각 θ만큼 **반시계** 방향으로 회전변환을 나타낸 행렬은 다음과 같다.

$$
R(\theta) =
\begin{pmatrix}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta
\end{pmatrix}
$$

이해를 위해 그림을 참고하자.

<img width="773" height="766" alt="image" src="https://github.com/user-attachments/assets/f877247c-cc7b-4388-a4a3-1b2a705b8867" />


그리고 다음은 y = e^-x의 회전변환에 대한 예시이다.

<img width="1277" height="731" alt="image" src="https://github.com/user-attachments/assets/7864ee7d-d44c-4e2a-b7c8-6d06d979d677" />


<br>

외우기 쉽게 코마싸싸코로 외우는데 보다보면 익숙해지는 꼴이다. <br>

그리고 3차원공간에서도 위 행렬 모양이 유지되서 외우기는 쉽다.<br>

<br>

② ℝ³ 일때에는 **양의 x축**, **양의 y축**, **양의 z축**을 중심으로 반시계방향으로의 회전변환이 있으며, 축 외에 직선이 있다.<br>

1. 양의 x축을 중심으로 각 θ만큼 반시계 방향으로 회전변환을 나타내는 행렬은 다음과 같다.
  

$$
\begin{pmatrix}
1 & 0 & 0 \\
0 & \cos\theta & -\sin\theta \\
0 & \sin\theta & \cos\theta
\end{pmatrix}
$$

이해를 위해 그림을 참고하자 <br>

<img width="1103" height="629" alt="image" src="https://github.com/user-attachments/assets/2e15bb7b-b437-4868-998d-6f7cef5e9846" />


2. 양의 y축을 중심으로 각 θ만큼 반시계 방향으로 회전변환을 나타내는 행렬은 다음과 같다.
  

$$
\begin{pmatrix}
\cos\theta & 0 & \sin\theta \\
0 & 1 & 0 \\
-\sin\theta & 0 & \cos\theta
\end{pmatrix}
$$

여기서 양의 y축 중심으로 반시계 방향으로 돌렸을때 x-z평면에서 보면 시계방향 회전처럼 되기 때문에 θ방향이 아닌 -θ방향으로 해서 계산한다. <br>

즉, 코마싸싸코가 아닌 코싸마싸코가 된다. <br>

이해를 위해 그림을 참고하자. <br>

<img width="820" height="676" alt="image" src="https://github.com/user-attachments/assets/34e08f07-4758-4687-90d8-e4cd897f4c33" />
<br>

3. 양의 z축을 중심으로 각 θ만큼 반시계 방향으로 회전변환을 나타내는 행렬은 다음과 같다.
  

$$
\begin{pmatrix}
\cos\theta & -\sin\theta & 0 \\
\sin\theta & \cos\theta & 0 \\
0 & 0 & 1
\end{pmatrix}
$$

이해를 위해 그림을 참고하자. <br>
<img width="799" height="679" alt="image" src="https://github.com/user-attachments/assets/f6804daf-322e-497a-8845-4b1cd101f79b" />


<br>

③ ℝ³에서 회전행렬이 주어졌을때 회전각과 회전축은 A가 3x3행렬로서 detA = 1이고, <br>

직교행렬이면, A의 곱은 어떤 회전축에 관하여 반시계 방향으로 다음을 만족하는 각도 θ만틈의 회전이다. <br>

여기서 detA = 1인이유는 크기는 보존되기 때문이다.

$$
cosθ = \frac{trA - 1}{2}
$$

행렬 A의 고유치 1에 대응하는 고유공간은 원점을 지나는 직선이고 회전축이된다. <br>

이해를 위해 그림을 참고하자

<img width="1137" height="823" alt="image" src="https://github.com/user-attachments/assets/f54c8b6c-2460-4290-879f-bcbe476f10fa" />

<br>

④ **로그리게스의 회전공식** <br>

ℝ³에서 단위벡터와 평행인 원점을 지나는 직선을 회전축으로 반시계 방향으로 회전시키는 회전변환의 표준행렬이다. <br>

계산량이 굉장히 많고, 몇몇은 기하적으로 풀 수 있지만 이 공식을 외우는게 더 쉬울정도로 어렵다.

$$
\begin{bmatrix}
aa(1-\cos\theta)+\cos\theta & ba(1-\cos\theta)-c\sin\theta & ca(1-\cos\theta)+b\sin\theta \\
ab(1-\cos\theta)+c\sin\theta & bb(1-\cos\theta)+\cos\theta & cb(1-\cos\theta)-a\sin\theta \\
ca(1-\cos\theta)-b\sin\theta & bc(1-\cos\theta)+a\sin\theta & cc(1-\cos\theta)+\cos\theta
\end{bmatrix}
$$
